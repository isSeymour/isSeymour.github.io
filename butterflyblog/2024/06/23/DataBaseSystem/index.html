<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>《数据库系统原理》知识点梳理 | isSeymour</title><meta name="author" content="isSeymour"><meta name="copyright" content="isSeymour"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="《数据库系统原理》知识点梳理  来源：同济大学《数据库系统原理》李文根老师课件 仅包含硬性知识点（背、记、看），不含理解性或实操性知识点（如SQL）。 2024-06-23@isSeymour  CH1 - 数据库系统概述 1.1 数据库系统   传统文件处理系统的缺点  数据的冗余和不一致性 （data redundancy and inconsistency） 数据访问困难（difficult">
<meta property="og:type" content="article">
<meta property="og:title" content="《数据库系统原理》知识点梳理">
<meta property="og:url" content="https://isseymour.github.io/butterflyblog/2024/06/23/DataBaseSystem/index.html">
<meta property="og:site_name" content="isSeymour">
<meta property="og:description" content="《数据库系统原理》知识点梳理  来源：同济大学《数据库系统原理》李文根老师课件 仅包含硬性知识点（背、记、看），不含理解性或实操性知识点（如SQL）。 2024-06-23@isSeymour  CH1 - 数据库系统概述 1.1 数据库系统   传统文件处理系统的缺点  数据的冗余和不一致性 （data redundancy and inconsistency） 数据访问困难（difficult">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Seymour0314/PicGo/posts/DatabaseSystemPrinciples/CoverPage.png">
<meta property="article:published_time" content="2024-06-23T13:00:00.000Z">
<meta property="article:modified_time" content="2024-06-22T16:00:00.000Z">
<meta property="article:author" content="isSeymour">
<meta property="article:tag" content="数据库系统原理">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/Seymour0314/PicGo/posts/DatabaseSystemPrinciples/CoverPage.png"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/Seymour0314/PicGo/blog/page_img/IC1011.ico"><link rel="canonical" href="https://isseymour.github.io/butterflyblog/2024/06/23/DataBaseSystem/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/butterflyblog/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/butterflyblog/',
  algolia: undefined,
  localSearch: {"path":"/butterflyblog/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":300},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '《数据库系统原理》知识点梳理',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-06-23 00:00:00'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/butterflyblog/code/style.css"><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://cdn.jsdelivr.net/gh/Seymour0314/PicGo/blog/page_img/T6.jpg" onerror="onerror=null;src='https://cdn.jsdelivr.net/gh/Seymour0314/PicGo/blog/page_img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/butterflyblog/archives/"><div class="headline">文章</div><div class="length-num">59</div></a><a href="/butterflyblog/tags/"><div class="headline">标签</div><div class="length-num">29</div></a><a href="/butterflyblog/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa-solid fa-book"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/butterflyblog/archives/"><i class="fa-fw fa-solid fa-timeline"></i><span> 总览</span></a></li><li><a class="site-page child" href="/butterflyblog/tags/"><i class="fa-fw fa-sharp fa-solid fa-hashtag"></i><span> 标签</span></a></li><li><a class="site-page child" href="/butterflyblog/categories/"><i class="fa-fw fa-sharp fa-solid fa-folder"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa-sharp fa-solid fa-list"></i><span> 功能</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/butterflyblog/ctf/"><i class="fa-fw fa-solid fa-shield-halved"></i><span> CTF</span></a></li><li><a class="site-page child" href="/butterflyblog/music/"><i class="fa-fw fa-solid fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/butterflyblog/tools/"><i class="fa-fw fa-solid fa-screwdriver-wrench"></i><span> 下载</span></a></li><li><a class="site-page child" href="/butterflyblog/link/"><i class="fa-fw fa-solid fa-paper-plane"></i><span> 链接</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa-regular fa-user"></i><span> 关于</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/butterflyblog/about/"><i class="fa-fw fa-regular fa-user"></i><span> 关于我</span></a></li><li><a class="site-page child" href="/butterflyblog/message/"><i class="fa-fw fa-solid fa-message"></i><span> 留言板</span></a></li><li><a class="site-page child" href="/butterflyblog/develop/"><i class="fa-fw fa-brands fa-windows"></i><span> 开发日志</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/gh/Seymour0314/PicGo/posts/DatabaseSystemPrinciples/CoverPage.png')"><nav id="nav"><span id="blog-info"><a href="/butterflyblog/" title="isSeymour"><span class="site-name">isSeymour</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa-solid fa-book"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/butterflyblog/archives/"><i class="fa-fw fa-solid fa-timeline"></i><span> 总览</span></a></li><li><a class="site-page child" href="/butterflyblog/tags/"><i class="fa-fw fa-sharp fa-solid fa-hashtag"></i><span> 标签</span></a></li><li><a class="site-page child" href="/butterflyblog/categories/"><i class="fa-fw fa-sharp fa-solid fa-folder"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa-sharp fa-solid fa-list"></i><span> 功能</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/butterflyblog/ctf/"><i class="fa-fw fa-solid fa-shield-halved"></i><span> CTF</span></a></li><li><a class="site-page child" href="/butterflyblog/music/"><i class="fa-fw fa-solid fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/butterflyblog/tools/"><i class="fa-fw fa-solid fa-screwdriver-wrench"></i><span> 下载</span></a></li><li><a class="site-page child" href="/butterflyblog/link/"><i class="fa-fw fa-solid fa-paper-plane"></i><span> 链接</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa-regular fa-user"></i><span> 关于</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/butterflyblog/about/"><i class="fa-fw fa-regular fa-user"></i><span> 关于我</span></a></li><li><a class="site-page child" href="/butterflyblog/message/"><i class="fa-fw fa-solid fa-message"></i><span> 留言板</span></a></li><li><a class="site-page child" href="/butterflyblog/develop/"><i class="fa-fw fa-brands fa-windows"></i><span> 开发日志</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">《数据库系统原理》知识点梳理</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-06-23T13:00:00.000Z" title="发表于 2024-06-23 21:00:00">2024-06-23</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-06-22T16:00:00.000Z" title="更新于 2024-06-23 00:00:00">2024-06-23</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/butterflyblog/categories/%E5%A4%A7%E5%AD%A6%E8%AF%BE%E7%A8%8B/">大学课程</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">6.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>21分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="《数据库系统原理》知识点梳理"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1>《数据库系统原理》知识点梳理</h1>
<blockquote>
<p>来源：同济大学《数据库系统原理》李文根老师课件</p>
<p>仅包含硬性知识点（背、记、看），不含理解性或实操性知识点（如SQL）。</p>
<p>2024-06-23@isSeymour</p>
</blockquote>
<h3 id="CH1-数据库系统概述">CH1 - 数据库系统概述</h3>
<h4 id="1-1-数据库系统">1.1 数据库系统</h4>
<ul>
<li>
<p><strong>传统文件处理系统的缺点</strong></p>
<ol>
<li>数据的冗余和不一致性 （data redundancy and inconsistency）</li>
<li>数据访问困难（difficulty in accessing data）</li>
<li>数据孤立（data isolation）</li>
<li>完整性问题（integrity problems）</li>
<li>原子性问题（atomicity problem）</li>
<li>并发访问异常（concurrent-access anomaly）</li>
<li>安全性问题（security problems）</li>
</ol>
</li>
<li>
<p><strong>数据库（Database, DB）</strong></p>
<ul>
<li>
<p><strong>什么是数据库？</strong></p>
<ul>
<li>一组相互有关联的数据集合</li>
<li>长期储存在计算机中的有组织的、可管理和可共享的数据集合</li>
</ul>
</li>
<li>
<p><strong>数据库的基本特征</strong></p>
<ul>
<li>数据按一定的数据模型组织、描述和储存</li>
<li>支持数据的增删改查</li>
<li>支持并发查询处理</li>
</ul>
</li>
<li>
<p><strong>什么是数据库系统？</strong></p>
<ul>
<li>
<p>数据库系统是指由数据库管理系统和相关工具组成的软件系统，用于管理和操作大量数据</p>
</li>
<li>
<p>一般包括</p>
<ol>
<li>数据库</li>
<li>数据库管理系统</li>
<li>开发工具、应用系统</li>
<li>数据库管理员和终端用户</li>
</ol>
</li>
</ul>
</li>
<li>
<p><strong>什么是数据库管理系统？</strong></p>
<ul>
<li>
<p>管理数据库的软件</p>
</li>
<li>
<p>定义1：用户（应用程序）与操作系统之间的数据库管理软件</p>
</li>
<li>
<p>定义2：一个管理数据的大型复杂基础软件系统</p>
</li>
</ul>
</li>
<li>
<p><strong>数据库管理系统的用途</strong></p>
<ol>
<li>优雅查询和数据抽象</li>
<li>高效组织和存储数据</li>
<li>正确一致的并发更新</li>
<li>低时延高吞吐的查询</li>
<li>并行高效的有序执行</li>
<li>可用性和高可靠保证</li>
<li>安全可信的统一控制</li>
<li>方便易用的用户接口</li>
</ol>
</li>
<li>
<p><strong>数据库的核心用途</strong></p>
<ol>
<li>数据库是数据基础设施</li>
<li>数据库是核心基础软件</li>
<li>数据库已赋能千行百业</li>
</ol>
<p>数据库是计算机的核心基础软件之一。向下发挥算力、向上支撑应用。</p>
</li>
</ul>
</li>
</ul>
<h4 id="1-2-数据视图">1.2 数据视图</h4>
<ul>
<li>
<p><strong>数据抽象的层次</strong></p>
<ol>
<li>物理层（Physical level）</li>
<li>逻辑层（Logical level）</li>
<li>视图层（View level）</li>
</ol>
</li>
<li>
<p><strong>模式与实例（Schema and Instance）</strong></p>
<ul>
<li>
<p>模式(Schema)</p>
<p>数据库的逻辑结构。三种模式：</p>
<ol>
<li>
<p>Physical schema(物理模式/内模式/存储模式): design at the physical level</p>
</li>
<li>
<p>Logical schema(逻辑模式/模式): design at the logical level</p>
</li>
<li>
<p>External schema(外模式/子模式): define at the app level</p>
</li>
</ol>
</li>
<li>
<p>实例(Instance)</p>
<p>特定时刻存储在数据库中信息的集合称为数据库的一个实例。</p>
</li>
</ul>
<blockquote>
<p>模式和实例之间的关系类似编程语言中<strong>数据类型</strong>和<strong>变量</strong>之间的关系。</p>
</blockquote>
<ul>
<li>物理数据独立性(Physical data independence)</li>
<li>逻辑数据独立性(Logical data independence)</li>
</ul>
</li>
<li>
<p><strong>数据模型(Data Models)</strong></p>
<p>描述数据、数据联系、数据语义及一致性约束的概念工具集合。</p>
<ol>
<li>关系模型(Relational model)</li>
<li>实体-联系模型(Entity-Relationship data model)</li>
<li>半结构化数据模型(Semi-structured data model)</li>
<li>基于对象的数据模型(Object-based data models)</li>
<li>其他数据模型</li>
</ol>
</li>
<li>
<p><strong>数据模型和数据库模式</strong></p>
<img src="https://cdn.jsdelivr.net/gh/isSeymour/PicGo/posts/DataBaseKnowledge/CH1-1.png" alt="CH1-1" style="zoom: 50%;" /> 
</li>
</ul>
<h4 id="1-3-数据库语言">1.3 数据库语言</h4>
<img src="https://cdn.jsdelivr.net/gh/isSeymour/PicGo/posts/DataBaseKnowledge/CH1-2.png" alt="CH1-2" style="zoom: 50%;" /> 
<ul>
<li>
<p><strong>数据库语言</strong></p>
<ul>
<li>
<p><strong>数据定义语言</strong>（Data-definition language, DDL)</p>
<p>定义数据库模式</p>
</li>
<li>
<p><strong>数据操纵语言</strong>（Data-manipulation language, DML)</p>
<p>访问或操纵按照某种适当数据模型组织的数据</p>
</li>
</ul>
<p>SQL同时包含DDL和DML。</p>
<blockquote>
<p>SQL: Structured Query Language, widely used non-procedural language</p>
</blockquote>
</li>
</ul>
<h4 id="1-4-数据库设计">1.4 数据库设计</h4>
<ul>
<li>
<p><strong>数据库结构设计过程</strong></p>
<ol>
<li>概念设计(Conceptual design)</li>
<li>逻辑设计(Logical design)</li>
<li>物理设计(Physical design)</li>
</ol>
</li>
<li>
<p><strong>E-R模型</strong></p>
<p>通过实体和关系建模数据</p>
</li>
</ul>
<h4 id="1-5-数据库引擎">1.5 数据库引擎</h4>
<ul>
<li>
<p><strong>组成</strong></p>
<ol>
<li>
<p>存储管理器(Storage manager)</p>
<p>存储访问、文件组织、索引</p>
</li>
<li>
<p>查询处理器(Query processor)</p>
<p>DDL解释器、DML编译器、查询执行引擎</p>
</li>
<li>
<p>事务管理器(Transaction manager)</p>
<p>并发控制管理器、恢复管理器</p>
</li>
</ol>
</li>
</ul>
<h4 id="1-6-数据库和应用体系结构">1.6 数据库和应用体系结构</h4>
<ul>
<li><strong>数据库系统结构</strong>
<ol>
<li>用户</li>
<li>应用和工具</li>
<li>数据库管理系统</li>
<li>数据库</li>
</ol>
</li>
<li><strong>数据库应用系统结构</strong>
<ol>
<li>两层体系结构</li>
<li>三层体系结构</li>
</ol>
</li>
</ul>
<h4 id="1-7-数据库用户和管理员">1.7 数据库用户和管理员</h4>
<ul>
<li>
<p><strong>数据库用户分类</strong></p>
<ol>
<li>Naive users（无经验用户)</li>
<li>Application programmers (应用程序员)</li>
<li>Sophisticated users（熟练用户）</li>
</ol>
</li>
<li>
<p><strong>数据库管理员(Database Administrator, DBA)</strong></p>
<p>DBA是数据库系统中所有活动的管理者和协调者，对DBMS以及企业的信息资源和需求有较好的理解。</p>
<p>DBA的职责：</p>
<ol>
<li>模式定义</li>
<li>存储结构和访问方法定义</li>
<li>修改架构和物理组织</li>
<li>授予数据访问授权</li>
<li>例行维护</li>
<li>指定完整性约束</li>
<li>与用户保持联系</li>
<li>监控性能，并对需求的变化做出反应</li>
</ol>
</li>
</ul>
<h4 id="1-8-数据库系统的历史">1.8 数据库系统的历史</h4>
<ul>
<li>
<p>数据库管理的三个历史阶段</p>
<img src="https://cdn.jsdelivr.net/gh/isSeymour/PicGo/posts/DataBaseKnowledge/CH1-3.png" alt="CH1-3" style="zoom:60%;" /> 
</li>
</ul>
<h4 id="1-9-前沿发展方向">1.9 前沿发展方向</h4>
<ul>
<li>
<p><strong>数据库的3次主要变革</strong></p>
<ol>
<li>
<p>第1代是<strong>单机数据库</strong></p>
<p>解决了数据存储、数据管理和查询处理等问题</p>
<p>代表系统包括Oracle, PostgreSQL和MySQL等</p>
</li>
<li>
<p>第2代是<strong>集群数据库</strong></p>
<p>旨在为企业关键业务提供高可用性和可靠性保障</p>
<p>代表系统包括Oracle RAC, IBM DB2和Microsoft SQL Server</p>
</li>
<li>
<p>第3代是<strong>分布式数据库</strong>和<strong>云原生数据库</strong></p>
<p>旨在解决大数据时代的<strong>弹性计算</strong>和<strong>动态数据迁移</strong>问题</p>
<p>代表系统包括亚马逊Aurora、华为openGauss和蚂蚁科技的OceanBase</p>
</li>
</ol>
</li>
<li>
<p><strong>四大目标与九大技术方向</strong></p>
<ol>
<li>降低成本，提升易用性。
<ul>
<li>HTAP数据库</li>
<li>多模数据管理</li>
<li>数据库+AI</li>
</ul>
</li>
<li>保障数据安全可信
<ul>
<li>防篡改数据库</li>
<li>全密态数据库</li>
</ul>
</li>
<li>提升功能，增强性能
<ul>
<li>软硬件协同发展</li>
<li>云原生数据库</li>
</ul>
</li>
<li>满足新兴业务需求
<ul>
<li>大规模图数据处理</li>
<li>实时湖仓</li>
</ul>
</li>
</ol>
</li>
</ul>
<h2 id="Part-1-关系数据库">Part-1 关系数据库</h2>
<h3 id="CH2-关系模型-Relational-model">CH2 - 关系模型 Relational model</h3>
<h4 id="2-1-关系数据库的结构">2.1 关系数据库的结构</h4>
<ul>
<li>关系、属性</li>
<li>关系模式、关系实例</li>
</ul>
<h4 id="2-2-数据库模式">2.2 数据库模式</h4>
<ul>
<li>无</li>
</ul>
<h4 id="2-3-码">2.3 码</h4>
<ul>
<li>
<p>超码(Superkey)</p>
</li>
<li>
<p>候选码(Candidate key)</p>
</li>
<li>
<p>主码(Primary key)</p>
</li>
<li>
<p>外码(Foreign key)</p>
</li>
<li>
<p>参照完整性约束(Referential integrity constraint)</p>
</li>
</ul>
<h4 id="2-4-模式图">2.4 模式图</h4>
<img src="https://cdn.jsdelivr.net/gh/isSeymour/PicGo/posts/DataBaseKnowledge/CH2-1.png" alt="CH2-1" style="zoom:60%;" /> 
<h4 id="2-5-关系查询语言">2.5 关系查询语言</h4>
<ul>
<li>
<p>分类</p>
<ol>
<li>
<p><strong>Procedural 过程式/函数式</strong></p>
<ul>
<li>Relational Algebra（关系代数）</li>
</ul>
</li>
<li>
<p><strong>Non-procedural/Declarative 非过程式/声明式</strong></p>
<ul>
<li>SQL（结构化查询语言）</li>
<li>Tuple Relational Calculus（元组关系演算）</li>
<li>Domain Relational Calculus（域关系演算）</li>
</ul>
</li>
</ol>
</li>
</ul>
<h4 id="2-6-关系代数">2.6 关系代数</h4>
<ul>
<li>
<p><strong>六大基本操作</strong></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mspace width="1em"/><mi>π</mi><mspace width="1em"/><mo>∪</mo><mspace width="1em"/><mo>−</mo><mspace width="1em"/><mo>×</mo><mspace width="1em"/><mi>ρ</mi></mrow><annotation encoding="application/x-tex">\sigma \quad \pi \quad \cup \quad - \quad \times \quad \rho</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5556em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">ρ</span></span></span></span></p>
<ol>
<li>Select (选择)</li>
<li>Project (投影)</li>
<li>Union (集合并)</li>
<li>Set difference (集合差)</li>
<li>Cartesian product (笛卡尔积)</li>
<li>Rename (重命名)</li>
</ol>
</li>
<li>
<p><strong>附加操作</strong></p>
<ol>
<li>Set intersection (集合交)</li>
<li>Natural join (自然连接)</li>
<li>Outer join（外连接）</li>
<li>Division (除)</li>
<li>Assignment (赋值)</li>
<li>聚合函数</li>
</ol>
</li>
<li>
<p><strong>聚合函数(Aggregate Functions)</strong></p>
<ul>
<li><strong>聚合操作：</strong>
<ul>
<li><strong>avg:</strong> average value</li>
<li><strong>min:</strong> minimum value</li>
<li><strong>max:</strong> maximum value</li>
<li><strong>sum:</strong> sum of values</li>
<li><strong>count:</strong> number of values</li>
</ul>
</li>
</ul>
<img src="https://cdn.jsdelivr.net/gh/isSeymour/PicGo/posts/DataBaseKnowledge/CH2-2.png" alt="CH2-2" style="zoom:60%;" /> 
</li>
</ul>
<h3 id="CH3-SQL介绍">CH3 - SQL介绍</h3>
<blockquote>
<p>本章实操多，概念没什么。</p>
</blockquote>
<ul>
<li>
<p><strong>SQL</strong></p>
<ul>
<li>DDL</li>
<li>DML</li>
</ul>
</li>
<li>
<p><strong>DDL</strong></p>
<ul>
<li>数据库模式、完整性约束等</li>
</ul>
</li>
<li>
<p><strong>SQL查询</strong></p>
<ul>
<li>
<p>select子句、from子句、where子句</p>
</li>
<li>
<p>natural join, join … using (…)</p>
</li>
</ul>
</li>
<li>
<p><strong>SQL附加运算</strong></p>
<ul>
<li>更名运算、字符串运算、排序order by</li>
</ul>
</li>
<li>
<p><strong>集合运算</strong></p>
<ul>
<li>union、intersect、except</li>
</ul>
</li>
<li>
<p><strong>空值</strong></p>
</li>
<li>
<p><strong>聚集函数</strong></p>
<ul>
<li>
<p>avg、min、max、sum、count</p>
</li>
<li>
<p>group by、having</p>
</li>
</ul>
</li>
<li>
<p><strong>嵌套子查询</strong></p>
<ul>
<li>
<p>集合包含：in、not in</p>
</li>
<li>
<p>集合比较：some子句、all子句、exists、unique</p>
</li>
<li>
<p>视图、导出关系、with子句、标量子查询</p>
</li>
</ul>
</li>
<li>
<p><strong>数据库的修改</strong></p>
<ul>
<li>Deletion、Insertion、Updates</li>
</ul>
</li>
</ul>
<h3 id="CH4-中级SQL">CH4 - 中级SQL</h3>
<ul>
<li>
<p><strong>连接类型</strong></p>
<ul>
<li>
<p>Inner and outer join</p>
</li>
<li>
<p>Left, right and full outer join</p>
</li>
<li>
<p>Natural, using, and on</p>
</li>
</ul>
</li>
<li>
<p><strong>视图</strong></p>
<ul>
<li>
<p>定义</p>
</li>
<li>
<p>物化视图</p>
</li>
<li>
<p>视图更新</p>
</li>
</ul>
</li>
<li>
<p><strong>事务</strong></p>
<ul>
<li>
<p>Commit work</p>
</li>
<li>
<p>Rollback work</p>
</li>
</ul>
</li>
<li>
<p><strong>完整性约束</strong></p>
<ul>
<li>
<p>实体完整性、域约束、唯一约束</p>
</li>
<li>
<p>Check子句</p>
</li>
<li>
<p>参照完整性</p>
</li>
<li>
<p>断言</p>
</li>
</ul>
</li>
<li>
<p><strong>数据类型</strong></p>
<ul>
<li>
<p>日期与时间类型</p>
</li>
<li>
<p>默认值</p>
</li>
<li>
<p>大对象</p>
</li>
<li>
<p>用户自定义类型</p>
</li>
</ul>
</li>
<li>
<p><strong>索引定义</strong></p>
</li>
<li>
<p><strong>授权</strong></p>
<ul>
<li>权限的授予与收回</li>
<li>权限：select、insert、update、all privileges</li>
<li>角色</li>
<li>视图的授权</li>
<li>行级授权</li>
</ul>
</li>
</ul>
<h3 id="CH5-高级SQL">CH5 - 高级SQL</h3>
<ul>
<li><strong>编程访问SQL</strong></li>
<li><strong>函数和过程</strong></li>
<li><strong>触发器</strong></li>
<li><strong>递归查询</strong></li>
<li><strong>高级聚集特性</strong></li>
</ul>
<h2 id="Part-2-数据库设计">Part-2 数据库设计</h2>
<h3 id="CH6-数据库设计与E-R模型">CH6 - 数据库设计与E-R模型</h3>
<h4 id="6-1-设计过程概览">6.1 设计过程概览</h4>
<ul>
<li>数据库设计阶段
<ol>
<li><strong>S1: Requirement analysis</strong></li>
<li><strong>S2: Conceptual design (E-R Model)</strong></li>
<li><strong>S3: Logical implementation</strong></li>
<li><strong>S4: Physical implementation</strong></li>
</ol>
</li>
</ul>
<h4 id="6-2-E-R模型">6.2 E-R模型</h4>
<ul>
<li>三个概念
<ol>
<li>实体集</li>
<li>属性</li>
<li>联系集</li>
</ol>
</li>
</ul>
<h4 id="6-3-约束">6.3 约束</h4>
<ul>
<li><strong>映射基数</strong>
<ol>
<li>One to one (1对1)</li>
<li>One to many (1对多)</li>
<li>Many to one (多对1)</li>
<li>Many to many (多对多)</li>
</ol>
</li>
<li><strong>参与约束</strong>
<ol>
<li><strong>Total participation</strong></li>
<li><strong>Partial participation</strong></li>
</ol>
</li>
</ul>
<h4 id="6-4-E-R图">6.4 E-R图</h4>
<ul>
<li>略</li>
</ul>
<h4 id="6-5-E-R图转换为关系模式">6.5 E-R图转换为关系模式</h4>
<img src="https://cdn.jsdelivr.net/gh/isSeymour/PicGo/posts/DataBaseKnowledge/CH6-1.png" alt="CH6-1" style="zoom:60%;" /> 
<h3 id="CH7-关系数据库设计优化">CH7 - 关系数据库设计优化</h3>
<h4 id="7-1-良好关系的特征">7.1 良好关系的特征</h4>
<ul>
<li>略</li>
</ul>
<h4 id="7-2-函数依赖">7.2 函数依赖</h4>
<blockquote>
<p>有大题，学会怎么做。</p>
</blockquote>
<ul>
<li>
<p>函数依赖（Functional Dependency）</p>
</li>
<li>
<p>分解（Decomposition）</p>
</li>
<li>
<p>无损连接分解（Lossy-join Decomposition）</p>
</li>
<li>
<p>函数依赖集的闭包</p>
</li>
<li>
<p>属性集的闭包（Closure of Attribute Set）</p>
</li>
<li>
<p>正则覆盖（Canonical Cover）</p>
</li>
<li>
<p>寻找候选码</p>
</li>
<li>
<p>无损连接分解的检测</p>
</li>
<li>
<p>依赖保持检测</p>
</li>
</ul>
<h4 id="7-3-规范化与范式">7.3 规范化与范式</h4>
<ul>
<li>
<p><strong>第一范式 1NF</strong></p>
<p>所有属性的域都是<strong>原子</strong>的。（不是多值属性）</p>
</li>
<li>
<p><strong>第二范式 2NF</strong></p>
<p>非主属性 对 候选码 没有<strong>部分</strong>函数依赖。</p>
</li>
<li>
<p><strong>第三范式 3NF</strong></p>
<p>非主属性 对 候选码 没有<strong>传递</strong>函数依赖。</p>
</li>
<li>
<p><strong>BC范式 BCNF</strong></p>
<p><strong>主</strong>属性 对 候选码 没有<strong>部分</strong>、<strong>传递</strong>函数依赖。</p>
</li>
</ul>
<h4 id="7-4-多值依赖">7.4 多值依赖</h4>
<ul>
<li><strong>第四范式 4NF</strong></li>
<li><strong>第五范式 5NF</strong></li>
</ul>
<h4 id="7-5-数据库设计过程">7.5 数据库设计过程</h4>
<ul>
<li>E-R模型和规范化</li>
<li>去规范化（Denormalization）</li>
<li>其他设计问题</li>
</ul>
<h2 id="Part-3-Application-Design-Development">Part 3 Application Design &amp; Development</h2>
<blockquote>
<p>没有</p>
</blockquote>
<h2 id="Part-4-Big-data-analytics">Part 4 Big data analytics</h2>
<blockquote>
<p>没有</p>
</blockquote>
<h2 id="Part-5-数据存储与检索">Part-5 数据存储与检索</h2>
<h3 id="CH12-13-物理存储系统-数据存储结构">CH12-13 - 物理存储系统 &amp; 数据存储结构</h3>
<blockquote>
<p>写的思维导图，不用管。</p>
<ul>
<li>物理存储介质概述</li>
<li>磁盘</li>
<li>闪存</li>
<li>RAID</li>
<li>三级存储</li>
<li>存储访问</li>
<li>文件组织</li>
<li>文件中记录的组织</li>
<li>数据字典存储</li>
</ul>
</blockquote>
<h3 id="CH14-索引-Indexing">CH14 - 索引 Indexing</h3>
<h4 id="14-1-基本概念">14.1 基本概念</h4>
<ul>
<li>
<p>索引可提高检索效率，其结构(二叉树、B+树等)占用空间小，访问速度快</p>
</li>
<li>
<p><strong>两种类型</strong></p>
<ol>
<li>ordered index (顺序索引)</li>
<li>hash index (散列索引)</li>
</ol>
</li>
<li>
<p><strong>索引评价标准</strong></p>
<ul>
<li>数据访问类型</li>
<li>数据访问时间</li>
<li>数据插入时间</li>
<li>数据删除时间</li>
<li>存储空间开销</li>
</ul>
</li>
</ul>
<h4 id="14-2-顺序索引">14.2 顺序索引</h4>
<ul>
<li>
<p><strong>聚集索引</strong></p>
<p>树形结构聚集索引的叶节点可以是数据节点。</p>
<p>索引顺序<strong>就是</strong>数据物理存储顺序。</p>
<blockquote>
<p>一个表最多只能有<strong>一个</strong>聚集索引。</p>
</blockquote>
</li>
<li>
<p><strong>非聚集索引</strong></p>
<p>树形结构非聚集索引的叶节点仍然是索引节点，通过指针指向对应的数据块。</p>
<p>非聚集索引顺序与数据物理排列顺序<strong>无关</strong>。</p>
</li>
<li>
<p><strong>稠密索引</strong></p>
<p>为文件中的每个搜索键值显示索引记录。</p>
</li>
<li>
<p><strong>稀疏索引</strong></p>
<p>当数据记录按搜索键顺序排序时，仅包含某些搜索键值的索引记录。</p>
</li>
<li>
<p><strong>多级索引</strong></p>
<p>为了减少对索引记录的磁盘访问次数，请将主索引视为一个顺序文件，并在其上构造一个稀疏索引。</p>
<ul>
<li>
<p><strong>inner index</strong></p>
<p>稀疏、稠密均可</p>
</li>
<li>
<p><strong>outer index</strong></p>
<p>稀疏</p>
</li>
</ul>
</li>
<li>
<p><strong>索引维护</strong></p>
<p>删除、插入</p>
</li>
</ul>
<blockquote>
<ul>
<li>
<p>二级索引必须是密集的</p>
</li>
<li>
<p>当数据文件被修改时，必须更新该文件的索引。更新索引会增加数据库修改的开销。</p>
</li>
<li>
<p>使用主索引的顺序扫描效率很高，但使用辅助索引的顺序扫描成本很高。每个记录访问可能从磁盘获取一个新的块。</p>
</li>
</ul>
</blockquote>
<h4 id="14-3-B-树和B树索引">14.3 B+树和B树索引</h4>
<blockquote>
<p>略，请去看实操方法，看这里的知识点，屁用没有。</p>
</blockquote>
<h4 id="14-4-散列索引">14.4 散列索引</h4>
<ul>
<li>
<p><strong>静态散列（Static Hashing）</strong></p>
<ul>
<li>散列文件组织</li>
<li>散列函数</li>
<li>溢出桶的处理</li>
</ul>
</li>
<li>
<p><strong>动态散列（Dynamic Hashing）</strong></p>
<ul>
<li>可扩展散列结构</li>
</ul>
</li>
<li>
<p><strong>对比 顺序索引</strong></p>
<ul>
<li>
<p>插入和删除的频率</p>
</li>
<li>
<p>是否以牺牲最坏情况访问时间为代价，优化平均访问时间</p>
</li>
<li>
<p>预期的查询类型</p>
<ol>
<li><strong>散列</strong>通常更适合检索具有指定键值的记录</li>
<li>如果范围查询是常见的，则选<strong>顺序</strong>索引</li>
</ol>
</li>
</ul>
</li>
</ul>
<h4 id="14-5-多码访问">14.5 多码访问</h4>
<ul>
<li>多属性索引</li>
<li>网格文件（Grid Files）</li>
<li>位图索引（Bitmap Indices）</li>
</ul>
<h4 id="14-6-索引创建">14.6 索引创建</h4>
<blockquote>
<p>屁用没有</p>
</blockquote>
<h2 id="Part-6-查询处理与优化">Part-6 查询处理与优化</h2>
<h3 id="CH15-查询处理-Query-processing">CH15 - 查询处理 Query processing</h3>
<h4 id="15-1-概述">15.1 概述</h4>
<ul>
<li><strong>查询处理的基本步骤</strong>
<ol>
<li>语法分析与翻译/Parsing and translation</li>
<li>优化/Optimization</li>
<li>执行/Execution</li>
</ol>
</li>
</ul>
<blockquote>
<p>后面部分不用知道，不会考</p>
<p>可以看一下归并排序。</p>
</blockquote>
<h3 id="CH16-查询优化-Query-optimization">CH16 - 查询优化 Query optimization</h3>
<h4 id="16-1-概述">16.1 概述</h4>
<ul>
<li>
<p><strong>Cost-based Optimization，基于代价的优化</strong></p>
<ol>
<li>
<p>步骤1：产生逻辑上与给定表达式等价的表达式</p>
<ul>
<li>使用等价规则</li>
</ul>
</li>
<li>
<p>步骤2：对所产生的表达式以不同方式标注，产生不同的查询执行计划</p>
</li>
<li>
<p>步骤3：估计每个执行计划的代价，选择估计代价最小的执行计划</p>
</li>
</ol>
</li>
</ul>
<img src="https://cdn.jsdelivr.net/gh/isSeymour/PicGo/posts/DataBaseKnowledge/CH16-1.png" alt="CH16-1" style="zoom:50%;" /> 
<h4 id="16-2-关系表达式的转换">16.2 关系表达式的转换</h4>
<ul>
<li>
<p><strong>等价规则</strong></p>
<img src="https://cdn.jsdelivr.net/gh/isSeymour/PicGo/posts/DataBaseKnowledge/CH16-2.png" alt="CH16-2" style="zoom: 50%;" /> 
<img src="https://cdn.jsdelivr.net/gh/isSeymour/PicGo/posts/DataBaseKnowledge/CH16-3.png" alt="CH16-3" style="zoom:50%;" /> 
<img src="https://cdn.jsdelivr.net/gh/isSeymour/PicGo/posts/DataBaseKnowledge/CH16-4.png" alt="CH16-4" style="zoom:50%;" /> 
<img src="https://cdn.jsdelivr.net/gh/isSeymour/PicGo/posts/DataBaseKnowledge/CH16-5.png" alt="CH16-5" style="zoom:50%;" /> 
<img src="https://cdn.jsdelivr.net/gh/isSeymour/PicGo/posts/DataBaseKnowledge/CH16-6.png" alt="CH16-6" style="zoom:50%;" /> 
</li>
</ul>
<h4 id="16-3-表达式执行代价估计">16.3 表达式执行代价估计</h4>
<blockquote>
<p>各种操作的代价大小估计，不用管</p>
</blockquote>
<h4 id="16-4-执行计划选择">16.4 执行计划选择</h4>
<ul>
<li>
<p>枚举等价表达式</p>
</li>
<li>
<p>执行计划</p>
</li>
<li>
<p>执行计划的选择</p>
</li>
<li>
<p>基于代价的优化</p>
</li>
<li>
<p>动态规划优化</p>
</li>
<li>
<p>连接顺序优化算法</p>
</li>
<li>
<p>左深连接树</p>
</li>
<li>
<p>成本优化</p>
</li>
<li>
<p>启发式优化</p>
<ol>
<li>
<p>将连接选择<strong>分解</strong>为一系列单个选择操作(等价规则1)。</p>
</li>
<li>
<p>将<strong>选择</strong>操作沿查询树<strong>下移</strong>，以便尽早执行(Equiv. rules 2,7a, 7b, 11)</p>
</li>
<li>
<p>首先执行那些<strong>产生最小关系的选择和连接</strong>操作(Equiv. rule 6)</p>
</li>
<li>
<p>用<strong>连接</strong>操作<strong>替换</strong>后面<strong>跟着选择条件的笛卡尔积</strong>操作(Equiv. rule 4a)</p>
</li>
<li>
<p>解构并尽可能地<strong>向下移动投影</strong>属性列表，在需要的地方创建新的投影(规则3、8)</p>
</li>
</ol>
</li>
</ul>
<h2 id="Part-7-事务管理">Part-7 事务管理</h2>
<h3 id="CH17-事务-Transactions">CH17 - 事务 Transactions</h3>
<h4 id="17-1-事务的概念">17.1 事务的概念</h4>
<ul>
<li>
<p>事务是由多个操作组成的程序执行单元。</p>
<ul>
<li>
<p>在事务执行过程中，可能出现数据库不一致的情况。</p>
</li>
<li>
<p>事务提交后，数据库必须保持一致。</p>
</li>
</ul>
</li>
<li>
<p><strong>两个主要问题</strong></p>
<ul>
<li>
<p>并发执行多个事务 -&gt; <strong>并发控制</strong>(Ch18)</p>
</li>
<li>
<p>从硬件故障和系统崩溃中恢复 -&gt; <strong>恢复</strong>(Ch19)</p>
</li>
</ul>
</li>
<li>
<p><strong>事务的ACID特性</strong></p>
<ol>
<li>Atomicity（原子性）</li>
<li>Consistency（一致性）</li>
<li>Isolation（隔离性）</li>
<li>Durability（持久性）</li>
</ol>
</li>
<li>
<p><strong>事务的状态</strong></p>
<ol>
<li>Active(活跃)</li>
<li>Partially committed(部分提交)</li>
<li>Failed(失败)</li>
<li>Aborted(中止)</li>
<li>Committed(提交)</li>
</ol>
<img src="https://cdn.jsdelivr.net/gh/isSeymour/PicGo/posts/DataBaseKnowledge/CH17-1.png" alt="CH17-1" style="zoom:50%;" /> 
</li>
</ul>
<h4 id="17-2-事务的调度">17.2 事务的调度</h4>
<ul>
<li><strong>调度（Schedule）</strong></li>
<li><strong>调度类型</strong>
<ol>
<li>serial schedule 串行化的调度</li>
<li>Non-serial schedule 非串行化的调度</li>
</ol>
</li>
</ul>
<h4 id="17-3-可串行化调度">17.3 可串行化调度</h4>
<ul>
<li>
<p><strong>可串行化</strong></p>
<ol>
<li>Conflict serializability（冲突可串行性）</li>
<li>View serializability（视图可串行性）</li>
</ol>
<p>注：只关注 read、write 操作</p>
</li>
<li>
<p><strong>冲突可串行化（Conflict Serializability）</strong></p>
<ul>
<li>𝐼𝑖 = read(Q), 𝐼𝑗 = read(Q). (no conflict)</li>
<li>𝐼𝑖 = read(Q), 𝐼𝑗 = write(Q). (conflict)</li>
<li>𝐼𝑖 = write(Q), 𝐼𝑗 = read(Q). (conflict)</li>
<li>𝐼𝑖 = write(Q), 𝐼𝑗 = write(Q). (conflict)</li>
</ul>
<p>直观地说，𝐼𝑖和𝐼𝑗之间的冲突迫使它们之间有一个(逻辑的)时间顺序</p>
</li>
<li>
<p><strong>Conflict equivalent (冲突等价)</strong></p>
</li>
<li>
<p><strong>视图可串行化（View Serializability）</strong></p>
</li>
</ul>
<h4 id="17-4-可恢复调度">17.4 可恢复调度</h4>
<ul>
<li>
<p><strong>不可恢复调度</strong></p>
<p>一个事务 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">T_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> 读取一个先前由一个事务 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">T_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 写入的数据项，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mi>i</mi></mrow><annotation encoding="application/x-tex">Ti</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal">i</span></span></span></span> 的提交操作出现在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mi>j</mi></mrow><annotation encoding="application/x-tex">Tj</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> 的提交操作之前。</p>
<table>
<thead>
<tr>
<th>T8</th>
<th>T9</th>
</tr>
</thead>
<tbody>
<tr>
<td>read(A)</td>
<td></td>
</tr>
<tr>
<td>write(A)</td>
<td></td>
</tr>
<tr>
<td></td>
<td>read(A)</td>
</tr>
<tr>
<td></td>
<td><strong>commit</strong></td>
</tr>
<tr>
<td>read(B)</td>
<td></td>
</tr>
</tbody>
</table>
</li>
<li>
<p><strong>Cascading rollback(级联回滚)</strong></p>
</li>
<li>
<p><strong>Cascadeless schedules (无级联回滚调度)</strong></p>
</li>
<li>
<p><strong>事务结束标志</strong></p>
<ol>
<li>commit</li>
<li>rollback</li>
</ol>
</li>
<li>
<p><strong>SQL-92指定的隔离级别 Levels of isolation</strong></p>
<ol>
<li>Serializable – default：保证可串行化调度</li>
<li>Repeatable read：只允许读取已提交数据，两次读取之间数据不能更新</li>
<li>Read committed：只允许读取已提交数据，不要求可重复读</li>
<li>Read uncommitted：允许读取未提交数据</li>
</ol>
</li>
</ul>
<h4 id="17-5-可串行性检测">17.5 可串行性检测</h4>
<ul>
<li>
<p><strong>Precedence graph（优先图）</strong></p>
<img src="https://cdn.jsdelivr.net/gh/isSeymour/PicGo/posts/DataBaseKnowledge/CH17-2.png" alt="CH17-2" style="zoom:50%;" /> 
</li>
<li>
<p><strong>检测方法</strong></p>
<p>当且仅当调度的优先级图<strong>不存在环</strong>时，则调度是可串行化的。</p>
</li>
</ul>
<h3 id="CH18-并发控制-Concurrency-control">CH18 - 并发控制  Concurrency control</h3>
<h4 id="18-1-并发控制中的问题">18.1 并发控制中的问题</h4>
<ul>
<li>
<p><strong>并发事务引起的问题</strong></p>
<ol>
<li>
<p><strong>Lost Update (丢失修改 )</strong></p>
<ul>
<li>事务T1和T2读取相同的数据项A并修改它。</li>
<li>T2的提交结果消除了T1的更新。</li>
</ul>
<img src="https://cdn.jsdelivr.net/gh/isSeymour/PicGo/posts/DataBaseKnowledge/CH18-1.png" alt="CH18-1" style="zoom: 33%;" /> 
</li>
<li>
<p><strong>Non-repeatable Read (不可重复读 )</strong></p>
<ul>
<li>T1读取B=100。</li>
<li>T2读取B，然后更新B=200，并写回B。</li>
<li>T1再次读取B, B=200，与第一次读取不同。</li>
<li>幻影现象(幻影现象)。同一查询的记录消失或新记录出现。</li>
</ul>
<img src="https://cdn.jsdelivr.net/gh/isSeymour/PicGo/posts/DataBaseKnowledge/CH18-2.png" alt="CH18-2" style="zoom: 33%;" /> 
</li>
<li>
<p><strong>Dirty Read (脏读 )</strong></p>
<ul>
<li>T1修改C为200，T2读取C是200。</li>
<li>T1由于某种原因回滚，它的修改也回滚。C恢复到100。</li>
<li>T2读取C为200，这与数据库不一致。</li>
</ul>
<img src="https://cdn.jsdelivr.net/gh/isSeymour/PicGo/posts/DataBaseKnowledge/CH18-3.png" alt="CH18-3" style="zoom:33%;" /> 
</li>
</ol>
</li>
</ul>
<h4 id="18-2-基于锁的协议">18.2 基于锁的协议</h4>
<ul>
<li>
<p><strong>Lock-based protocols</strong></p>
<p>一种控制并发访问数据项的机制。</p>
<ul>
<li>
<p>数据项可以以两种模式锁定：</p>
<ol>
<li>exclusive (X) mode (排他锁)</li>
<li>shared (S) mode (共享锁)</li>
</ol>
</li>
<li>
<p>锁请求(并发控制管理器)</p>
<p>只有锁请求被批准后，事务才能继续进行。</p>
</li>
<li>
<p>解决问题：</p>
<ol>
<li>丢失修改</li>
<li>不可重复读</li>
<li>脏读</li>
</ol>
<p>均已解决。</p>
</li>
</ul>
</li>
<li>
<p><strong>两阶段锁协议（Two-Phase Locking Protocol）</strong></p>
<p>一种确保可冲突序列化调度的协议</p>
<ul>
<li>
<p>第一阶段:成长阶段(增长阶段)</p>
<p>事务可以<strong>获取</strong>锁，但不能释放锁</p>
</li>
<li>
<p>第二阶段:收缩阶段(缩减阶段)</p>
<p>事务可以<strong>释放</strong>锁，但不能获取锁</p>
</li>
</ul>
<p>该协议保证了可串行化。</p>
<ul>
<li>
<p>分类</p>
<ol>
<li>
<p>Strict two-phase locking(严格两阶段封锁)</p>
<p>事务在提交之前必须持有所有的排他锁。可以实现级联回滚。</p>
</li>
<li>
<p>Rigorous two-phase locking (强两阶段封锁)</p>
<p>所有的锁被持有直到事务提交。</p>
</li>
</ol>
</li>
</ul>
</li>
<li>
<p><strong>锁转换（Lock Conversions）</strong></p>
<ol>
<li>
<p>Upgrade (升级)</p>
<p>lock-S -&gt; lock-X</p>
</li>
<li>
<p>Downgrade (降级)</p>
<p>lock-X -&gt; lock-S</p>
</li>
</ol>
</li>
<li>
<p><strong>锁的自动获取</strong></p>
</li>
<li>
<p><strong>锁的实现</strong></p>
<p>Lock manager (锁管理器)</p>
</li>
<li>
<p><strong>锁表（Lock Table）</strong></p>
</li>
<li>
<p><strong>死锁（Deadlock）</strong></p>
<p>如果存在一组事务，其中的每个事务都在等待另一个事务，那么系统就会发生死锁。</p>
<ul>
<li>
<p>要处理死锁，必须<strong>中止或回滚</strong>某些事务并<strong>释放其锁</strong></p>
</li>
<li>
<p>大多数锁协议都存在死锁</p>
</li>
<li>
<p>两阶段锁（严格、强）都不能避免死锁</p>
</li>
</ul>
</li>
<li>
<p><strong>饥饿（Starvation）</strong></p>
<p>一个事务可能正在等待一个数据项的X锁，而其他一系列事务请求并被授予相同数据项的S锁。由于死锁，同一个事务被反复回滚，一直得不到资源，这种现象就叫饥饿。</p>
<ul>
<li>并发控制管理器可以设计为防止饥饿</li>
</ul>
</li>
</ul>
<h4 id="18-3-基于图的协议">18.3 基于图的协议</h4>
<ul>
<li>
<p><strong>Graph-based protocols</strong></p>
<p>基于图的协议是两阶段锁定的替代方案。</p>
</li>
<li>
<p><strong>树协议（Tree Protocol）</strong></p>
<p>树协议是一种简单的图协议。</p>
<ul>
<li>
<p>在树协议中只允许使用排他锁。</p>
</li>
<li>
<p>流程</p>
<ol>
<li>事务 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">T_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 的第一个锁可以在任何数据项上。</li>
<li>随后，只有当数据 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span></span></span></span> 的父节点当前被 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">T_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 锁住时，数据 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span></span></span></span> 才能被 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">T_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 锁住。</li>
<li>数据项可以随时解锁。</li>
<li>已解锁的数据项不能通过 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">T_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 重新锁定。</li>
</ol>
</li>
</ul>
</li>
<li>
<p><strong>优点</strong></p>
<ol>
<li>树协议确保<strong>冲突可串行化</strong>以及<strong>免于死锁</strong>。</li>
<li><strong>解锁</strong>可能比两阶段锁定协议<strong>更早</strong>发生，因此<strong>等待时间更短，并发性更高</strong>。</li>
</ol>
</li>
<li>
<p><strong>缺点</strong></p>
<ol>
<li>事务的<strong>中止</strong>仍然会<strong>导致级联回滚</strong>。</li>
<li><strong>可能</strong>必须<strong>锁定它不访问的数据项</strong>，从而<strong>增加锁定开销</strong>，并<strong>产生额外的等待时间</strong>。</li>
</ol>
</li>
</ul>
<h4 id="18-4-基于时间戳的协议">18.4 基于时间戳的协议</h4>
<ul>
<li>
<p><strong>事务的时间戳</strong></p>
<p>每个事务在进入系统时都有一个时间戳。</p>
</li>
<li>
<p><strong>Timestamp-based protocol</strong></p>
<p>为了确保可串行化，协议为每个数据维护两个时间戳值。</p>
<ol>
<li>
<p>W-timestamp(Q)</p>
<p>成功执行write(Q)的所有事务的最大时间戳</p>
</li>
<li>
<p>R-timestamp(Q)</p>
<p>成功执行read(Q)的所有事务的最大时间戳</p>
</li>
</ol>
<p>基于时间戳的协议确保任何冲突的读写操作都按照时间戳顺序执行。</p>
</li>
<li>
<p>时间戳协议确保<strong>没有死锁</strong>，因为没有事务等待。</p>
</li>
</ul>
<h4 id="18-5-死锁处理">18.5 死锁处理</h4>
<ul>
<li>
<p><strong>死锁</strong></p>
<p>如果存在一组事务，其中的每个事务都在等待另一个事务，那么系统就会发生死锁。</p>
</li>
<li>
<p><strong>Deadlock prevention protocols 死锁防止协议</strong></p>
<p>确保系统永远不会进入死锁状态。</p>
<ul>
<li>
<p>要求每个事务在开始执行之前锁定其所有数据项(预声明)</p>
</li>
<li>
<p>强制所有数据项的部分排序，并要求事务只能按照部分排序指定的顺序锁定数据项(基于图的协议)</p>
</li>
</ul>
</li>
<li>
<p><strong>死锁预防</strong></p>
<ol>
<li>基于图的协议</li>
<li>基于时间戳的协议</li>
</ol>
<ul>
<li>
<p>其中的协调控制：</p>
<ul>
<li>
<p>wait-die scheme — non-preemptive(非抢占)</p>
<p>旧事务让出给新事务。</p>
<p>可能导致事务死亡。</p>
</li>
<li>
<p>wound-wait scheme — preemptive(抢占)</p>
<p>新事务让出给旧事务。</p>
<p>回滚的概率更低。</p>
</li>
</ul>
<blockquote>
<p>回滚的事务使用其原始时间戳重新启动。</p>
<p>旧事务因此优先于新事务，从而避免了饥饿。</p>
</blockquote>
</li>
<li>
<p>Timeout-based schemes (基于超时的机制)</p>
<ul>
<li>事务在指定的时间内等待锁。在此之后，事务被回滚，因此不可能出现死锁。</li>
<li>执行起来很简单，但是可能会饿死。也很难确定好值的超时间隔。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>死锁检测</strong></p>
<p>画 wait-for graph(等待图) 。查看是否存在环。</p>
<ul>
<li>必须定期调用死锁检测算法来查找周期。</li>
</ul>
</li>
<li>
<p><strong>死锁恢复</strong></p>
<ol>
<li>某些事务需要回滚。</li>
<li>确定回滚事务的程度。
<ul>
<li><strong>Total rollback</strong>：中止事务，然后重新启动</li>
<li><strong>Partial rollback</strong>：只要需要回滚到打破死锁即可。</li>
</ul>
</li>
</ol>
<ul>
<li>
<p>如果总是选择相同的事务作为被回滚事务，就会发生饥饿。</p>
<p>因此，可以在成本因素中包括回滚的次数，以避免饥饿。</p>
</li>
</ul>
</li>
</ul>
<h4 id="18-6-多粒度">18.6 多粒度</h4>
<ul>
<li>
<p>允许数据项具有各种大小，并定义数据粒度的层次结构。</p>
</li>
<li>
<p><strong>粒度的控制</strong></p>
<ol>
<li>
<p>细粒度(树中较低)</p>
<p>高并发性，高锁定开销</p>
</li>
<li>
<p>粗粒度(在树中较高)</p>
<p>低并发性，低锁定开销</p>
</li>
</ol>
</li>
<li>
<p><strong>意向锁（Intention Lock）</strong></p>
<ol>
<li>intention-shared (IS): 意向共享模式锁</li>
<li>intention-exclusive (IX): 意向排他模式锁</li>
<li>shared intention-exclusive (SIX): 共享意向排他锁</li>
</ol>
<p>意图锁允许以S或X模式锁定更高级别的节点，而不必检查所有的子节点。</p>
</li>
<li>
<p><strong>锁相容性矩阵</strong></p>
<img src="https://cdn.jsdelivr.net/gh/isSeymour/PicGo/posts/DataBaseKnowledge/CH18-4.png" alt="CH18-4" style="zoom:33%;" /> 
</li>
</ul>
<h3 id="CH19-恢复系统-Recovery-System">CH19 - 恢复系统 Recovery System</h3>
<h4 id="19-1-故障分类">19.1 故障分类</h4>
<ul>
<li>
<p><strong>故障分类</strong></p>
<ol>
<li><strong>Transaction failure (事务故障）</strong>
<ul>
<li>Logical errors, e.g., illegal inputs 非法输入</li>
<li>System errors, e.g., dead locks 死锁</li>
</ul>
</li>
<li><strong>System crash (系统崩溃)</strong>
<ul>
<li>电源故障</li>
<li>其他硬件和软件故障</li>
</ul>
</li>
<li><strong>Disk failure (磁盘故障）</strong>
<ul>
<li>磁头故障</li>
</ul>
</li>
</ol>
</li>
<li>
<p><strong>恢复算法</strong></p>
<p>保证有足够的信息用于故障恢复。</p>
<p>恢复数据库到某个一致性状态。</p>
</li>
</ul>
<h4 id="19-2-存储器">19.2 存储器</h4>
<ul>
<li>
<p><strong>存储器分类</strong></p>
<ol>
<li>Volatile storage (易失性存储器)</li>
<li>Non-volatile storage (非易失性存储器）</li>
<li>Stable storage (稳定存储器)</li>
</ol>
</li>
<li>
<p><strong>数据访问</strong></p>
<ol>
<li>Physical blocks （物理块）</li>
<li>Buffer blocks （缓冲块）</li>
</ol>
<img src="https://cdn.jsdelivr.net/gh/isSeymour/PicGo/posts/DataBaseKnowledge/CH19-1.png" alt="CH19-1" style="zoom: 50%;" /> 
</li>
</ul>
<h4 id="19-3-恢复与原子性">19.3 恢复与原子性</h4>
<ul>
<li>
<p><strong>两种策略</strong></p>
<ol>
<li>Log-based recovery (基于日志的恢复)</li>
<li>Shadow-paging (影子页)</li>
</ol>
</li>
<li>
<p><strong>基于日志的恢复</strong></p>
<p>日志保存在稳定的存储中。</p>
<p>使用 log 的两种强度：</p>
<ol>
<li>Deferred database modification (延迟数据库修改)</li>
<li>Immediate database modification (即刻数据库修改)</li>
</ol>
</li>
<li>
<p><strong>延迟数据库修改</strong></p>
<ul>
<li>
<p>将所有修改记录到日志中，但将所有写操作推迟到部分提交之后。</p>
<ul>
<li>事务开始：记录<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><msub><mi>T</mi><mi>i</mi></msub><mspace width="1em"/><mi>s</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>t</mi><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">&lt;T_i \quad start&gt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span></span></span></span>在日志里</li>
<li>事务写入操作：记录<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><msub><mi>T</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>X</mi><mo separator="true">,</mo><msub><mi>V</mi><mrow><mi>o</mi><mi>l</mi><mi>d</mi></mrow></msub><mo separator="true">,</mo><msub><mi>V</mi><mrow><mi>n</mi><mi>e</mi><mi>w</mi></mrow></msub><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">&lt;T_i,X, V_{old},V_{new}&gt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span></span></span></span> 在日志里，但此时不在X上执行写操作，而是被延迟了。</li>
<li>当<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">T_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>部分提交时，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><msub><mi>T</mi><mi>i</mi></msub><mspace width="1em"/><mi>c</mi><mi>o</mi><mi>m</mi><mi>m</mi><mi>i</mi><mi>t</mi><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">&lt;T_i \quad commit&gt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">co</span><span class="mord mathnormal">mmi</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span></span></span></span> 被写入日志，并读取日志记录开始执行先前延迟的写操作。</li>
</ul>
</li>
<li>
<p><strong>Recovery after a crash</strong> 恢复</p>
<ul>
<li>如果日志中同时存在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><msub><mi>T</mi><mi>i</mi></msub><mspace width="1em"/><mi>s</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>t</mi><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">&lt;T_i \quad start&gt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span></span></span></span> 和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><msub><mi>T</mi><mi>i</mi></msub><mspace width="1em"/><mi>c</mi><mi>o</mi><mi>m</mi><mi>m</mi><mi>i</mi><mi>t</mi><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">&lt;T_i \quad commit&gt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">co</span><span class="mord mathnormal">mmi</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span></span></span></span>，则需要重新执行事务。</li>
<li>使用 redo 将事务更新的所有数据项的值设置为新值</li>
</ul>
</li>
</ul>
<blockquote>
<p>例子: T0 在 T1 之前执行，初始化:A=1000, B=2000, C=700</p>
<img src="https://cdn.jsdelivr.net/gh/isSeymour/PicGo/posts/DataBaseKnowledge/CH19-2.png" alt="CH19-2" style="zoom: 50%;" /> 
<p>发生故障时的三种可能状态如下：</p>
<img src="https://cdn.jsdelivr.net/gh/isSeymour/PicGo/posts/DataBaseKnowledge/CH19-3.png" alt="CH19-3" style="zoom: 50%;" /> 
<ul>
<li>A：不需要redo</li>
<li>B：T0需要redo</li>
<li>C：T0、T1均需要redo</li>
</ul>
</blockquote>
</li>
<li>
<p><strong>即刻数据库修改</strong></p>
<p>允许未提交事务的数据库更新。</p>
<p>恢复过程有两个操作：</p>
<ol>
<li>undo：撤销恢复旧值</li>
<li>redo：重做恢复新值</li>
</ol>
<ul>
<li>要求：
<ol>
<li>已经 start 但未 commit 的需要undo 。</li>
<li>已经 start 且 commit 的需要redo。</li>
<li>先执行 undo ，再执行 redo。</li>
</ol>
</li>
</ul>
<blockquote>
<p>例子：</p>
<p>状态记录log如下：</p>
<img src="https://cdn.jsdelivr.net/gh/isSeymour/PicGo/posts/DataBaseKnowledge/CH19-4.png" alt="CH19-4" style="zoom:50%;" /> 
<ul>
<li>A：undo(T0)</li>
<li>B：undo(T1)、redo(T0)</li>
<li>C：redo(T0)、redo(T1)</li>
</ul>
</blockquote>
</li>
<li>
<p><strong>检查点（Checkpoint）</strong></p>
<ul>
<li>
<p>恢复过程中的问题</p>
<ul>
<li>搜索整个日志非常耗时</li>
<li>可能不必要地重做已经向数据库输出更新的事务</li>
</ul>
</li>
<li>
<p>设置检查点</p>
<ul>
<li>
<p>将当前主存中的所有日志记录输出到稳定的存储中</p>
</li>
<li>
<p>将修改后的所有缓冲块输出到磁盘</p>
</li>
<li>
<p>将日志记录<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><mi>c</mi><mi>h</mi><mi>e</mi><mi>c</mi><mi>k</mi><mi>p</mi><mi>o</mi><mi>i</mi><mi>n</mi><mi>t</mi><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">&lt;checkpoint&gt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">h</span><span class="mord mathnormal">ec</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal">p</span><span class="mord mathnormal">o</span><span class="mord mathnormal">in</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span></span></span></span>写入稳定存储</p>
</li>
</ul>
</li>
<li>
<p>恢复时</p>
<ul>
<li>从日志的末尾开始扫描以查找最近的&lt;检查点&gt;记录</li>
<li>倒着继续扫描，直到找到<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><msub><mi>T</mi><mi>i</mi></msub><mspace width="1em"/><mi>s</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>t</mi><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">&lt;T_i \quad start&gt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span></span></span></span>记录。（我们假设所有的事务都是连续执行的）</li>
<li>只需要考虑这个 start 与故障之间的记录即可。
<ol>
<li>没有commit的，执行undo</li>
<li>已经commit的，执行redo</li>
</ol>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>示例：</p>
<img src="https://cdn.jsdelivr.net/gh/isSeymour/PicGo/posts/DataBaseKnowledge/CH19-5.png" alt="CH19-5" style="zoom:50%;" /> 
<ul>
<li>T1忽略</li>
<li>undo T4</li>
<li>redo T2和T3</li>
</ul>
</blockquote>
</li>
</ul>
<h4 id="19-4-恢复算法">19.4 恢复算法</h4>
<ul>
<li>
<p><strong>并发事务的恢复</strong></p>
<p>做法和前面一样。</p>
<ul>
<li>
<p>但是checkpoint要写成<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><mi>c</mi><mi>h</mi><mi>e</mi><mi>c</mi><mi>k</mi><mi>p</mi><mi>o</mi><mi>i</mi><mi>n</mi><mi>t</mi><mspace width="1em"/><mi>L</mi><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">&lt;checkpoint \quad L&gt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">h</span><span class="mord mathnormal">ec</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal">p</span><span class="mord mathnormal">o</span><span class="mord mathnormal">in</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span></span></span></span></p>
<p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span> 是检查点被设置时，处于活动状态的事务列表（已start但未commit的）。</p>
</li>
</ul>
</li>
</ul>
<h4 id="19-5-缓冲区管理">19.5 缓冲区管理</h4>
<blockquote>
<p>不知所云。。。</p>
</blockquote>
<h2 id="QUIZ">*QUIZ</h2>
<h3 id="CH7-函数依赖与范式">CH7 函数依赖与范式</h3>
<img src="https://cdn.jsdelivr.net/gh/isSeymour/PicGo/posts/DataBaseKnowledge/CH7-1.png" alt="CH7-1" style="zoom:60%;" /> 
<h3 id="CH14-B-树索引">CH14 B+树索引</h3>
<img src="https://cdn.jsdelivr.net/gh/isSeymour/PicGo/posts/DataBaseKnowledge/CH14-1.png" alt="CH14-1" style="zoom:60%;" /> 
<h3 id="CH15-归并排序">CH15 归并排序</h3>
<img src="https://cdn.jsdelivr.net/gh/isSeymour/PicGo/posts/DataBaseKnowledge/CH15-1.png" alt="CH15-1" style="zoom: 50%;" /> 
<h3 id="CH16-查询优化">CH16 查询优化</h3>
<img src="https://cdn.jsdelivr.net/gh/isSeymour/PicGo/posts/DataBaseKnowledge/CH16-7.png" alt="CH16-7" style="zoom: 50%;" /> 
<img src="https://cdn.jsdelivr.net/gh/isSeymour/PicGo/posts/DataBaseKnowledge/CH16-8.png" alt="CH16-8" style="zoom:50%;" /> 
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://isSeymour.github.io/butterflyblog">isSeymour</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://isseymour.github.io/butterflyblog/2024/06/23/DataBaseSystem/">https://isseymour.github.io/butterflyblog/2024/06/23/DataBaseSystem/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://isSeymour.github.io/butterflyblog" target="_blank">isSeymour</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/butterflyblog/tags/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86/">数据库系统原理</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/Seymour0314/PicGo/posts/DatabaseSystemPrinciples/CoverPage.png" data-sites="wechat,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>赞助</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/Seymour0314/PicGo/blog/pay/PAY1.jpg" target="_blank"><img class="post-qr-code-img" src="https://cdn.jsdelivr.net/gh/Seymour0314/PicGo/blog/pay/PAY1.jpg" alt="微信支付"/></a><div class="post-qr-code-desc">微信支付</div></li><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/Seymour0314/PicGo/blog/pay/PAY2.jpg" target="_blank"><img class="post-qr-code-img" src="https://cdn.jsdelivr.net/gh/Seymour0314/PicGo/blog/pay/PAY2.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/butterflyblog/2024/06/02/CVDL-9-T/" title="CVDL - Transformer"><img class="cover" src="https://cdn.jsdelivr.net/gh/isSeymour/PicGo/posts/CVDL-bupt/C9-Page0.png" onerror="onerror=null;src='https://cdn.jsdelivr.net/gh/Seymour0314/PicGo/blog/page_img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">CVDL - Transformer</div></div></a></div><div class="next-post pull-right"><a href="/butterflyblog/2024/07/21/NTL-tutorial/" title="《NTL库》使用教程（C++ 现代密码学）"><img class="cover" src="https://cdn.jsdelivr.net/gh/isSeymour/PicGo/posts/NTL-tutorial/NTL-P0.png" onerror="onerror=null;src='https://cdn.jsdelivr.net/gh/Seymour0314/PicGo/blog/page_img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">《NTL库》使用教程（C++ 现代密码学）</div></div></a></div></nav><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://cdn.jsdelivr.net/gh/Seymour0314/PicGo/blog/page_img/T6.jpg" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/Seymour0314/PicGo/blog/page_img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">isSeymour</div><div class="author-info__description">志之所趋，无远弗届，穷山距海，不能限也。</div></div><div class="card-info-data site-data is-center"><a href="/butterflyblog/archives/"><div class="headline">文章</div><div class="length-num">59</div></a><a href="/butterflyblog/tags/"><div class="headline">标签</div><div class="length-num">29</div></a><a href="/butterflyblog/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/isSeymour/"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://isSeymour.github.io/profile/" target="_blank" title="学术主页"><i class="fa-regular fa-address-card" style="color: #000000;"></i></a><a class="social-icon" href="https://github.com/isSeymour/" target="_blank" title="Github"><i class="fab fa-github" style="color: #hdhfbb;"></i></a><a class="social-icon" href="https://space.bilibili.com/79699613/" target="_blank" title="B站"><i class="fa-brands fa-bilibili" style="color: #000000;"></i></a><a class="social-icon" href="https://blog.csdn.net/m0_63205991/" target="_blank" title="CSDN"><i class="fa-solid fa-code" style="color: #000000;"></i></a><a class="social-icon" href="mailto:isSeymour@163.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #000000;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">评论区正式上线！GitHub官方评论！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">《数据库系统原理》知识点梳理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CH1-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%BF%B0"><span class="toc-text">CH1 - 数据库系统概述</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F"><span class="toc-text">1.1 数据库系统</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-%E6%95%B0%E6%8D%AE%E8%A7%86%E5%9B%BE"><span class="toc-text">1.2 数据视图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%AD%E8%A8%80"><span class="toc-text">1.3 数据库语言</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-4-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1"><span class="toc-text">1.4 数据库设计</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-5-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%BC%95%E6%93%8E"><span class="toc-text">1.5 数据库引擎</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-6-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%92%8C%E5%BA%94%E7%94%A8%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84"><span class="toc-text">1.6 数据库和应用体系结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-7-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%94%A8%E6%88%B7%E5%92%8C%E7%AE%A1%E7%90%86%E5%91%98"><span class="toc-text">1.7 数据库用户和管理员</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-8-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%8E%86%E5%8F%B2"><span class="toc-text">1.8 数据库系统的历史</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-9-%E5%89%8D%E6%B2%BF%E5%8F%91%E5%B1%95%E6%96%B9%E5%90%91"><span class="toc-text">1.9 前沿发展方向</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Part-1-%E5%85%B3%E7%B3%BB%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">Part-1 关系数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CH2-%E5%85%B3%E7%B3%BB%E6%A8%A1%E5%9E%8B-Relational-model"><span class="toc-text">CH2 - 关系模型 Relational model</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-%E5%85%B3%E7%B3%BB%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E7%BB%93%E6%9E%84"><span class="toc-text">2.1 关系数据库的结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A8%A1%E5%BC%8F"><span class="toc-text">2.2 数据库模式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-%E7%A0%81"><span class="toc-text">2.3 码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-%E6%A8%A1%E5%BC%8F%E5%9B%BE"><span class="toc-text">2.4 模式图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-%E5%85%B3%E7%B3%BB%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80"><span class="toc-text">2.5 关系查询语言</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-6-%E5%85%B3%E7%B3%BB%E4%BB%A3%E6%95%B0"><span class="toc-text">2.6 关系代数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CH3-SQL%E4%BB%8B%E7%BB%8D"><span class="toc-text">CH3 - SQL介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CH4-%E4%B8%AD%E7%BA%A7SQL"><span class="toc-text">CH4 - 中级SQL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CH5-%E9%AB%98%E7%BA%A7SQL"><span class="toc-text">CH5 - 高级SQL</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Part-2-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1"><span class="toc-text">Part-2 数据库设计</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CH6-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E4%B8%8EE-R%E6%A8%A1%E5%9E%8B"><span class="toc-text">CH6 - 数据库设计与E-R模型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6-1-%E8%AE%BE%E8%AE%A1%E8%BF%87%E7%A8%8B%E6%A6%82%E8%A7%88"><span class="toc-text">6.1 设计过程概览</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-2-E-R%E6%A8%A1%E5%9E%8B"><span class="toc-text">6.2 E-R模型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-3-%E7%BA%A6%E6%9D%9F"><span class="toc-text">6.3 约束</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-4-E-R%E5%9B%BE"><span class="toc-text">6.4 E-R图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-5-E-R%E5%9B%BE%E8%BD%AC%E6%8D%A2%E4%B8%BA%E5%85%B3%E7%B3%BB%E6%A8%A1%E5%BC%8F"><span class="toc-text">6.5 E-R图转换为关系模式</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CH7-%E5%85%B3%E7%B3%BB%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E4%BC%98%E5%8C%96"><span class="toc-text">CH7 - 关系数据库设计优化</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#7-1-%E8%89%AF%E5%A5%BD%E5%85%B3%E7%B3%BB%E7%9A%84%E7%89%B9%E5%BE%81"><span class="toc-text">7.1 良好关系的特征</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-2-%E5%87%BD%E6%95%B0%E4%BE%9D%E8%B5%96"><span class="toc-text">7.2 函数依赖</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-3-%E8%A7%84%E8%8C%83%E5%8C%96%E4%B8%8E%E8%8C%83%E5%BC%8F"><span class="toc-text">7.3 规范化与范式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-4-%E5%A4%9A%E5%80%BC%E4%BE%9D%E8%B5%96"><span class="toc-text">7.4 多值依赖</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-5-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E8%BF%87%E7%A8%8B"><span class="toc-text">7.5 数据库设计过程</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Part-3-Application-Design-Development"><span class="toc-text">Part 3 Application Design &amp; Development</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Part-4-Big-data-analytics"><span class="toc-text">Part 4 Big data analytics</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Part-5-%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E4%B8%8E%E6%A3%80%E7%B4%A2"><span class="toc-text">Part-5 数据存储与检索</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CH12-13-%E7%89%A9%E7%90%86%E5%AD%98%E5%82%A8%E7%B3%BB%E7%BB%9F-%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%84"><span class="toc-text">CH12-13 - 物理存储系统 &amp; 数据存储结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CH14-%E7%B4%A2%E5%BC%95-Indexing"><span class="toc-text">CH14 - 索引 Indexing</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#14-1-%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-text">14.1 基本概念</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#14-2-%E9%A1%BA%E5%BA%8F%E7%B4%A2%E5%BC%95"><span class="toc-text">14.2 顺序索引</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#14-3-B-%E6%A0%91%E5%92%8CB%E6%A0%91%E7%B4%A2%E5%BC%95"><span class="toc-text">14.3 B+树和B树索引</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#14-4-%E6%95%A3%E5%88%97%E7%B4%A2%E5%BC%95"><span class="toc-text">14.4 散列索引</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#14-5-%E5%A4%9A%E7%A0%81%E8%AE%BF%E9%97%AE"><span class="toc-text">14.5 多码访问</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#14-6-%E7%B4%A2%E5%BC%95%E5%88%9B%E5%BB%BA"><span class="toc-text">14.6 索引创建</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Part-6-%E6%9F%A5%E8%AF%A2%E5%A4%84%E7%90%86%E4%B8%8E%E4%BC%98%E5%8C%96"><span class="toc-text">Part-6 查询处理与优化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CH15-%E6%9F%A5%E8%AF%A2%E5%A4%84%E7%90%86-Query-processing"><span class="toc-text">CH15 - 查询处理 Query processing</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#15-1-%E6%A6%82%E8%BF%B0"><span class="toc-text">15.1 概述</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CH16-%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-Query-optimization"><span class="toc-text">CH16 - 查询优化 Query optimization</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#16-1-%E6%A6%82%E8%BF%B0"><span class="toc-text">16.1 概述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#16-2-%E5%85%B3%E7%B3%BB%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9A%84%E8%BD%AC%E6%8D%A2"><span class="toc-text">16.2 关系表达式的转换</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#16-3-%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%89%A7%E8%A1%8C%E4%BB%A3%E4%BB%B7%E4%BC%B0%E8%AE%A1"><span class="toc-text">16.3 表达式执行代价估计</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#16-4-%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92%E9%80%89%E6%8B%A9"><span class="toc-text">16.4 执行计划选择</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Part-7-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86"><span class="toc-text">Part-7 事务管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CH17-%E4%BA%8B%E5%8A%A1-Transactions"><span class="toc-text">CH17 - 事务 Transactions</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#17-1-%E4%BA%8B%E5%8A%A1%E7%9A%84%E6%A6%82%E5%BF%B5"><span class="toc-text">17.1 事务的概念</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#17-2-%E4%BA%8B%E5%8A%A1%E7%9A%84%E8%B0%83%E5%BA%A6"><span class="toc-text">17.2 事务的调度</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#17-3-%E5%8F%AF%E4%B8%B2%E8%A1%8C%E5%8C%96%E8%B0%83%E5%BA%A6"><span class="toc-text">17.3 可串行化调度</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#17-4-%E5%8F%AF%E6%81%A2%E5%A4%8D%E8%B0%83%E5%BA%A6"><span class="toc-text">17.4 可恢复调度</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#17-5-%E5%8F%AF%E4%B8%B2%E8%A1%8C%E6%80%A7%E6%A3%80%E6%B5%8B"><span class="toc-text">17.5 可串行性检测</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CH18-%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6-Concurrency-control"><span class="toc-text">CH18 - 并发控制  Concurrency control</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#18-1-%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6%E4%B8%AD%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-text">18.1 并发控制中的问题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#18-2-%E5%9F%BA%E4%BA%8E%E9%94%81%E7%9A%84%E5%8D%8F%E8%AE%AE"><span class="toc-text">18.2 基于锁的协议</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#18-3-%E5%9F%BA%E4%BA%8E%E5%9B%BE%E7%9A%84%E5%8D%8F%E8%AE%AE"><span class="toc-text">18.3 基于图的协议</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#18-4-%E5%9F%BA%E4%BA%8E%E6%97%B6%E9%97%B4%E6%88%B3%E7%9A%84%E5%8D%8F%E8%AE%AE"><span class="toc-text">18.4 基于时间戳的协议</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#18-5-%E6%AD%BB%E9%94%81%E5%A4%84%E7%90%86"><span class="toc-text">18.5 死锁处理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#18-6-%E5%A4%9A%E7%B2%92%E5%BA%A6"><span class="toc-text">18.6 多粒度</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CH19-%E6%81%A2%E5%A4%8D%E7%B3%BB%E7%BB%9F-Recovery-System"><span class="toc-text">CH19 - 恢复系统 Recovery System</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#19-1-%E6%95%85%E9%9A%9C%E5%88%86%E7%B1%BB"><span class="toc-text">19.1 故障分类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#19-2-%E5%AD%98%E5%82%A8%E5%99%A8"><span class="toc-text">19.2 存储器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#19-3-%E6%81%A2%E5%A4%8D%E4%B8%8E%E5%8E%9F%E5%AD%90%E6%80%A7"><span class="toc-text">19.3 恢复与原子性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#19-4-%E6%81%A2%E5%A4%8D%E7%AE%97%E6%B3%95"><span class="toc-text">19.4 恢复算法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#19-5-%E7%BC%93%E5%86%B2%E5%8C%BA%E7%AE%A1%E7%90%86"><span class="toc-text">19.5 缓冲区管理</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#QUIZ"><span class="toc-text">*QUIZ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CH7-%E5%87%BD%E6%95%B0%E4%BE%9D%E8%B5%96%E4%B8%8E%E8%8C%83%E5%BC%8F"><span class="toc-text">CH7 函数依赖与范式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CH14-B-%E6%A0%91%E7%B4%A2%E5%BC%95"><span class="toc-text">CH14 B+树索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CH15-%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F"><span class="toc-text">CH15 归并排序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CH16-%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96"><span class="toc-text">CH16 查询优化</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/butterflyblog/2024/09/23/ML2021-HW5/" title="ML2021 - HW 5"><img src="https://cdn.jsdelivr.net/gh/isSeymour/PicGo/posts/ML2021/ML2021.png" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/Seymour0314/PicGo/blog/page_img/404.jpg'" alt="ML2021 - HW 5"/></a><div class="content"><a class="title" href="/butterflyblog/2024/09/23/ML2021-HW5/" title="ML2021 - HW 5">ML2021 - HW 5</a><time datetime="2024-09-22T16:00:00.000Z" title="发表于 2024-09-23 00:00:00">2024-09-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/butterflyblog/2024/09/21/ML2021-HW4/" title="ML2021 - HW 4"><img src="https://cdn.jsdelivr.net/gh/isSeymour/PicGo/posts/ML2021/HW3/header.png" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/Seymour0314/PicGo/blog/page_img/404.jpg'" alt="ML2021 - HW 4"/></a><div class="content"><a class="title" href="/butterflyblog/2024/09/21/ML2021-HW4/" title="ML2021 - HW 4">ML2021 - HW 4</a><time datetime="2024-09-20T16:00:00.000Z" title="发表于 2024-09-21 00:00:00">2024-09-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/butterflyblog/2024/09/14/ML2021-HW3/" title="ML2021 - HW 3"><img src="https://cdn.jsdelivr.net/gh/isSeymour/PicGo/posts/ML2021/HW3/header.png" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/Seymour0314/PicGo/blog/page_img/404.jpg'" alt="ML2021 - HW 3"/></a><div class="content"><a class="title" href="/butterflyblog/2024/09/14/ML2021-HW3/" title="ML2021 - HW 3">ML2021 - HW 3</a><time datetime="2024-09-13T16:00:00.000Z" title="发表于 2024-09-14 00:00:00">2024-09-14</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://cdn.jsdelivr.net/gh/Seymour0314/PicGo/posts/DatabaseSystemPrinciples/CoverPage.png')"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2024 By isSeymour</div><div class="footer_custom_text">欢迎乘坐我的生活地铁！</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/butterflyblog/js/utils.js"></script><script src="/butterflyblog/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex/dist/contrib/copy-tex.min.js"></script><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', { class: 'katex-wrap'})
  })
})()</script><script>(() => {
  const initGitalk = () => {
    const gitalk = new Gitalk(Object.assign({
      clientID: 'Ov23liAZxomGv7Hapw8g',
      clientSecret: 'f7cafde192c4ada8bef4b76952c422d90575cf8b',
      repo: 'gitalk',
      owner: 'isSeymour',
      admin: ['isSeymour'],
      id: '00c2aec35ff3a9e8cad3387965104e3d',
      updateCountCallback: commentCount
    },null))

    gitalk.render('gitalk-container')
  }

  const loadGitalk = async() => {
    if (typeof Gitalk === 'function') initGitalk()
    else {
      await getCSS('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css')
      await getScript('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.js')
      initGitalk()
    }
  }
  
  const commentCount = n => {
    const isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
    if (isCommentCount) {
      isCommentCount.textContent= n
    }
  }

  if ('Gitalk' === 'Gitalk' || !false) {
    if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
    else loadGitalk()
  } else {
    window.loadOtherComment = loadGitalk
  }
})()</script></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/butterflyblog/js/search/local-search.js"></script></div></div></body></html>